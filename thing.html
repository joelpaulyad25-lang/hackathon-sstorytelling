<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Space Weather Explained</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            color: #fff;
            position: relative;
            min-height: 100vh;
        }

        .video-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            overflow: hidden;
        }

        .video-background iframe {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .video-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(10, 14, 39, 0.7);
            z-index: -1;
        }

        /* Main Website Styles */
        .main-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
            position: relative;
            z-index: 1;
        }

        header {
            text-align: center;
            margin-bottom: 60px;
            padding: 40px 20px;
            background: rgba(30, 60, 114, 0.7);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        header h1 {
            font-size: 48px;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        header p {
            font-size: 18px;
            opacity: 0.9;
            max-width: 800px;
            margin: 0 auto;
            line-height: 1.6;
        }

        .content-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }

        .card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 30px;
            transition: transform 0.3s ease;
            display: flex;
            flex-direction: column;
        }

        .card:hover {
            transform: translateY(-5px);
        }

        .card h2 {
            font-size: 24px;
            margin-bottom: 15px;
            color: #667eea;
            display: flex;
            align-items: center;
        }

        .card h2 span {
            margin-right: 10px;
        }

        .card p {
            line-height: 1.6;
            opacity: 0.9;
            margin-bottom: 15px;
        }

        .card ul {
            padding-left: 20px;
            margin-bottom: 15px;
        }

        .card li {
            margin-bottom: 8px;
            line-height: 1.5;
        }

        .card .fact-box {
            background: rgba(102, 126, 234, 0.1);
            border-left: 4px solid #667eea;
            padding: 15px;
            margin-top: 15px;
            border-radius: 4px;
        }

        .card .fact-box h4 {
            color: #a8b1ff;
            margin-bottom: 5px;
        }

        /* Chat Widget Styles */
        .chat-widget {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
        }

        .chat-button {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            cursor: pointer;
            box-shadow: 0 4px 20px rgba(102, 126, 234, 0.6);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .chat-button:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 30px rgba(102, 126, 234, 0.8);
        }

        .chat-button svg {
            width: 30px;
            height: 30px;
            fill: white;
        }

        .chat-popup {
            position: absolute;
            bottom: 80px;
            right: 0;
            width: 400px;
            height: 600px;
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
            display: none;
            flex-direction: column;
            overflow: hidden;
            animation: slideUp 0.3s ease;
        }

        .chat-popup.active {
            display: flex;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .chat-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .chat-header h3 {
            font-size: 18px;
            font-weight: 600;
        }

        .close-btn {
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: background 0.3s ease;
        }

        .close-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        #chat {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            background: linear-gradient(to bottom, #f8f9fa 0%, #e9ecef 100%);
        }

        #chat::-webkit-scrollbar {
            width: 6px;
        }

        #chat::-webkit-scrollbar-track {
            background: transparent;
        }

        #chat::-webkit-scrollbar-thumb {
            background: rgba(102, 126, 234, 0.3);
            border-radius: 10px;
        }

        #chat li {
            list-style: none;
            margin-bottom: 12px;
            padding: 10px 15px;
            border-radius: 15px;
            max-width: 80%;
            word-wrap: break-word;
            animation: slideIn 0.3s ease;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            font-size: 14px;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .user-msg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            margin-left: auto;
            border-bottom-right-radius: 4px;
        }

        .server-msg {
            background: white;
            color: #333;
            margin-right: auto;
            border-bottom-left-radius: 4px;
            border: 1px solid #e0e0e0;
        }

        .empty-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            color: #999;
            text-align: center;
        }

        .empty-state svg {
            width: 60px;
            height: 60px;
            margin-bottom: 15px;
            opacity: 0.5;
        }

        .empty-state p {
            font-size: 16px;
            margin-bottom: 5px;
        }

        .empty-state small {
            font-size: 12px;
        }

        .input-area {
            padding: 15px;
            background: white;
            border-top: 1px solid #e0e0e0;
            display: flex;
            gap: 10px;
        }

        #messageInput {
            flex: 1;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 20px;
            font-size: 14px;
            outline: none;
            transition: all 0.3s ease;
        }

        #messageInput:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .send-btn {
            padding: 12px 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .send-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        @media (max-width: 480px) {
            .chat-popup {
                width: calc(100vw - 40px);
                height: 500px;
            }
            
            header h1 {
                font-size: 36px;
            }
        }
    </style>
</head>
<body>
    <!-- Video Background -->
    <div class="video-background">
        <iframe src="https://www.youtube.com/embed/eTD0WWFIDAg?autoplay=1&mute=1&loop=1&playlist=eTD0WWFIDAg&controls=0&showinfo=0&rel=0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
    </div>
    <div class="video-overlay"></div>

    <!-- Main Website Content -->
    <div class="main-content">
        <header>
            <h1>🌌 Space Weather Explained</h1>
            <p>Space weather refers to the environmental conditions in space as influenced by the Sun and the solar wind. Understanding these phenomena helps us protect satellites, power grids, and communication systems on Earth.</p>
        </header>

        <div class="content-grid">
            <div class="card">
                <h2><span>☀️</span> Solar Activity</h2>
                <p>The Sun is a dynamic star that goes through cycles of activity. Solar activity includes phenomena like:</p>
                <ul>
                    <li>Sunspots - cooler, darker regions on the Sun's surface</li>
                    <li>Solar flares - sudden bursts of radiation</li>
                    <li>Coronal Mass Ejections (CMEs) - massive eruptions of solar material</li>
                </ul>
                <p>These events can release enormous amounts of energy and charged particles into space.</p>
                <div class="fact-box">
                    <h4>Did You Know?</h4>
                    <p>A single large solar flare can release more energy than a million volcanic eruptions on Earth.</p>
                </div>
            </div>

            <div class="card">
                <h2><span>🛰️</span> Satellite Impacts</h2>
                <p>Space weather can significantly affect satellites in orbit around Earth:</p>
                <ul>
                    <li>Increased radiation can damage electronic components</li>
                    <li>Charged particles can cause electrostatic discharges</li>
                    <li>Atmospheric drag increases during solar storms, altering orbits</li>
                    <li>Communication signals can be disrupted or degraded</li>
                </ul>
                <p>Satellite operators monitor space weather to protect their assets and maintain services.</p>
                <div class="fact-box">
                    <h4>Impact</h4>
                    <p>In 2022, SpaceX lost 40 Starlink satellites due to a geomagnetic storm that increased atmospheric drag.</p>
                </div>
            </div>

            <div class="card">
                <h2><span>🌍</span> Geomagnetic Storms</h2>
                <p>When solar material interacts with Earth's magnetic field, it can cause geomagnetic storms:</p>
                <ul>
                    <li>G1 (Minor) - Small power grid fluctuations, minor impact on satellites</li>
                    <li>G2 (Moderate) - High-latitude power systems affected, increased drag on satellites</li>
                    <li>G3 (Strong) - Voltage corrections needed, satellite navigation issues</li>
                    <li>G4 (Severe) - Widespread voltage problems, satellite tracking issues</li>
                    <li>G5 (Extreme) - Complete grid collapse possible, satellites may be disabled</li>
                </ul>
                <div class="fact-box">
                    <h4>Historical Event</h4>
                    <p>The Carrington Event of 1859 was so powerful that telegraph systems failed and auroras were seen near the equator.</p>
                </div>
            </div>

            <div class="card">
                <h2><span>📡</span> Radio Communication</h2>
                <p>Space weather significantly impacts radio communications:</p>
                <ul>
                    <li>Solar flares can cause radio blackouts on the sunlit side of Earth</li>
                    <li>Ionospheric disturbances affect HF (shortwave) radio propagation</li>
                    <li>GPS signals can experience degradation during solar storms</li>
                    <li>Polar routes are particularly vulnerable to communication disruptions</li>
                </ul>
                <p>Aviation, maritime, and emergency services rely on space weather forecasts to plan operations.</p>
                <div class="fact-box">
                    <h4>Practical Effect</h4>
                    <p>During solar events, airlines may reroute polar flights to maintain communication and reduce radiation exposure.</p>
                </div>
            </div>

            <div class="card">
                <h2><span>🌠</span> Auroras</h2>
                <p>Auroras (Northern and Southern Lights) are beautiful visual displays caused by space weather:</p>
                <ul>
                    <li>Charged particles from the Sun collide with Earth's atmosphere</li>
                    <li>These particles are guided by Earth's magnetic field toward the poles</li>
                    <li>Different gases produce different colors (green, red, purple)</li>
                    <li>The Kp index measures geomagnetic activity and predicts auroral visibility</li>
                </ul>
                <p>During strong geomagnetic storms, auroras can be seen at much lower latitudes than normal.</p>
                <div class="fact-box">
                    <h4>Viewing Tip</h4>
                    <p>The best time to see auroras is typically around midnight, away from city lights, during periods of high solar activity.</p>
                </div>
            </div>

            <div class="card">
                <h2><span>☄️</span> Cosmic Radiation</h2>
                <p>Cosmic rays are high-energy particles originating from outside our solar system:</p>
                <ul>
                    <li>Galactic cosmic rays come from outside our solar system</li>
                    <li>Solar cosmic rays are emitted by the Sun during flares</li>
                    <li>Earth's atmosphere and magnetic field provide protection</li>
                    <li>Radiation levels increase during solar minimum periods</li>
                </ul>
                <p>This radiation poses challenges for astronauts, high-altitude aviation, and satellite electronics.</p>
                <div class="fact-box">
                    <h4>Health Impact</h4>
                    <p>Airline crew members receive more cosmic radiation exposure than nuclear power plant workers, making them classified as radiation workers in some countries.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Chat Widget -->
    <div class="chat-widget">
        <button class="chat-button" onclick="toggleChat()">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                <path d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H6l-2 2V4h16v12z"/>
            </svg>
        </button>

        <div class="chat-popup" id="chatPopup">
            <div class="chat-header">
                <h3>💬 Space Weather Assistant</h3>
                <button class="close-btn" onclick="toggleChat()">×</button>
            </div>

            <ul id="chat">
                <div class="empty-state">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />
                    </svg>
                    <p>Ask about space weather</p>
                    <small>I'm here to help!</small>
                </div>
            </ul>

            <div class="input-area">
                <input 
                    type="text" 
                    id="messageInput" 
                    placeholder="Ask me anything..." 
                    autocomplete="off"
                />
                <button class="send-btn" onclick="sendMessage()">Send</button>
            </div>
        </div>
    </div>

    <script>
        const chatPopup = document.getElementById('chatPopup');
        const chat = document.getElementById('chat');
        const messageInput = document.getElementById('messageInput');
        let conversationHistory = [];

        function toggleChat() {
            chatPopup.classList.toggle('active');
            if (chatPopup.classList.contains('active')) {
                messageInput.focus();
            }
        }

        function removeEmptyState() {
            const emptyState = chat.querySelector('.empty-state');
            if (emptyState) {
                emptyState.remove();
            }
        }

        messageInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });

        async function sendMessage() {
            const text = messageInput.value.trim();
            if (!text) return;

            removeEmptyState();

            conversationHistory.push({
                role: "user",
                content: text
            });

            const liUser = document.createElement('li');
            liUser.textContent = text;
            liUser.classList.add('user-msg');
            chat.appendChild(liUser);

            chat.scrollTop = chat.scrollHeight;
            messageInput.value = '';

            try {
                const res = await fetch('http://127.0.0.1:5000/api/messages', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify(conversationHistory)
                });
                
                const data = await res.json();
                const responseText = typeof data === 'string' ? data : data.response || data.message || JSON.stringify(data);

                conversationHistory.push({
                    role: "assistant",
                    content: responseText
                });

                const liServer = document.createElement('li');
                liServer.textContent = responseText;
                liServer.classList.add('server-msg');
                chat.appendChild(liServer);

                chat.scrollTop = chat.scrollHeight;
            } catch (err) {
                console.error("Error sending message:", err);
                
                const liError = document.createElement('li');
                liError.textContent = '❌ Could not connect to server';
                liError.classList.add('server-msg');
                liError.style.color = '#e74c3c';
                chat.appendChild(liError);
                
                chat.scrollTop = chat.scrollHeight;
            }
        }
    </script>
</body>
</html>